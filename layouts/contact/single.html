<!DOCTYPE html>
<html lang="{{ .Site.Language.Lang }}">
  <head>
    <title>{{ .Title }} | {{ .Site.Title }}</title>
    <meta name="description" content="{{ .Description }}" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {{- partial "header.html" . -}}
    {{- partial "opengraph.html" . -}}
    {{- partial "analytics.html" . -}}
  </head>
  <body data-bs-spy="scroll" data-bs-target="#top-navbar" data-bs-offset="100">
    <!--- NAVBAR ------------------------->
    {{- partial "navigators/navbar.html" . -}}

    <!--- MAIN CONTENT ------------------------->
    <section class="container-fluid section-holder d-flex bg-dimmed" style="min-height: 100vh; padding-top: 100px;">
      <div class="container-fluid anchor p-0">
        <div class="row justify-content-center">
          <div class="col-lg-8">
            
            <div class="text-center mb-5">
              <h1 class="text-white bg-dark text-center py-3 px-4 rounded shadow">{{ .Title }}</h1>
              <div class="contact-intro-text lead">{{ .Content }}</div>
            </div>

            <!-- Contact Form Card -->
            <div class="card shadow-sm border-0 mb-5">
              <div class="card-header bg-primary text-white text-center py-3">
                <h3 class="mb-1">Contact Form</h3>
                <small class="opacity-75">I look forward to hearing from you</small>
              </div>
              
              <div class="card-body p-4">
                <form id="contact-page-form">
                  <div class="row">
                    <div class="col-md-6 mb-3">
                      <label for="contact-name" class="form-label fw-bold text-center py-3">Your Name *</label>
                      <input type="text" class="form-control form-control-lg" id="contact-name" required placeholder="John Smith">
                    </div>
                    
                    <div class="col-md-6 mb-3">
                      <label for="contact-email" class="form-label fw-bold text-center py-3">Email Address *</label>
                      <input type="email" class="form-control form-control-lg" id="contact-email" required placeholder="john@company.com">
                    </div>
                  </div>
                  
                  <div class="row">
                    <div class="col-md-6 mb-3">
                      <label for="contact-company" class="form-label fw-bold text-center py-3">Company</label>
                      <input type="text" class="form-control form-control-lg" id="contact-company" placeholder="Your Company">
                    </div>
                    
                    <div class="col-md-6 mb-3">
                      <label for="contact-phone" class="form-label fw-bold text-center py-3">Phone</label>
                      <input type="tel" class="form-control form-control-lg" id="contact-phone" placeholder="(555) 123-4567">
                    </div>
                  </div>
                  
                  <div class="mb-3">
                    <label for="contact-subject" class="form-label fw-bold text-center py-3">Subject *</label>
                    <select class="form-select form-select-lg" id="contact-subject" required>
                      <option value="">Select a topic...</option>
                      <option value="job-opportunity">üíº Job Opportunity</option>
                      <option value="consultation">üîß Technical Consultation</option>
                      <option value="project-collaboration">ü§ù Project Collaboration</option>
                      <option value="networking">üåê Professional Networking</option>
                      <option value="speaking">üé§ Speaking Engagement</option>
                      <option value="other">üìù Other</option>
                    </select>
                  </div>
                  
                  <div class="mb-4">
                    <label for="contact-message" class="form-label fw-bold text-center py-3">Message *</label>
                    <textarea class="form-control" id="contact-message" rows="6" required placeholder="Tell me about your opportunity, project, or how you'd like to connect..."></textarea>
                  </div>
                  
                  <div class="text-center">
                    <button type="submit" id="contact-submit" class="btn btn-primary btn-lg px-5 py-3">
                      <i class="fas fa-paper-plane me-2"></i>Submit
                    </button>
                    <div id="contact-status" class="mt-3 fw-bold text-center py-3">Ready to send</div>
                  </div>
                </form>
              </div>
            </div>

            <!-- Contact Methods -->
            <div class="row g-4 mb-5">
              <div class="col-md-4">
                <div class="card h-100 text-center border-primary">
                  <div class="card-body">
                    <div class="text-primary fs-1 mb-3">
                      <i class="fas fa-envelope"></i>
                    </div>
                    <h5 class="card-title">Email</h5>
                    <p class="card-text text-muted">Direct professional email</p>
                    <a href="mailto:Ray@200rx.com" class="btn btn-outline-primary">Ray@200rx.com</a>
                  </div>
                </div>
              </div>
              
              <div class="col-md-4">
                <div class="card h-100 text-center border-info">
                  <div class="card-body">
                    <div class="text-info fs-1 mb-3">
                      <i class="fab fa-linkedin"></i>
                    </div>
                    <h5 class="card-title">LinkedIn</h5>
                    <p class="card-text text-muted">Professional networking</p>
                    <a href="https://www.linkedin.com/in/coreyvmiller/" target="_blank" class="btn btn-outline-info">LinkedIn Profile</a>
                  </div>
                </div>
              </div>
              
              <div class="col-md-4">
                <div class="card h-100 text-center border-primary">
                  <div class="card-body">
                    <div class="text-primary fs-1 mb-3">
                      <i class="fab fa-github"></i>
                    </div>
                    <h5 class="card-title">GitHub</h5>
                    <p class="card-text text-muted">Technical portfolio & code</p>
                    <a href="https://github.com/404RX" target="_blank" class="btn btn-outline-primary">GitHub Profile</a>
                  </div>
                </div>
              </div>
            </div>

            <!-- What I Can Help With -->
            <div class="card shadow-sm border-0 mb-5">
              <div class="card-header bg-secondary text-white">
                <h4 class="mb-0 text-center">üí° What I Can Help With</h4>
              </div>
              <div class="card-body">
                <div class="row">
                  <div class="col-md-4 mb-3">
                    <h6 class="text-primary">üîß System Administration</h6>
                    <ul class="list-unstyled text-muted small">
                      <li>‚Ä¢ Windows Server environments</li>
                      <li>‚Ä¢ Active Directory management</li>
                      <li>‚Ä¢ PowerShell automation</li>
                      <li>‚Ä¢ Network infrastructure</li>
                    </ul>
                  </div>
                  <div class="col-md-4 mb-3">
                    <h6 class="text-primary">‚òÅÔ∏è Cloud & DevOps</h6>
                    <ul class="list-unstyled text-muted small">
                      <li>‚Ä¢ Azure & AWS administration</li>
                      <li>‚Ä¢ Infrastructure as Code</li>
                      <li>‚Ä¢ CI/CD pipeline setup</li>
                      <li>‚Ä¢ Container orchestration</li>
                    </ul>
                  </div>
                  <div class="col-md-4 mb-3">
                    <h6 class="text-primary">üíº Professional Services</h6>
                    <ul class="list-unstyled text-muted small">
                      <li>‚Ä¢ Technical consultation</li>
                      <li>‚Ä¢ Architecture planning</li>
                      <li>‚Ä¢ Team leadership</li>
                      <li>‚Ä¢ Training & mentoring</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>

            <!-- Call to Action -->
            <div class="text-center mb-5">
              <div class="card bg-primary text-white">
                <div class="card-body py-4">
                  <h4 class="mb-2">Ready to Work Together?</h4>
                  <p class="mb-0 opacity-75">Fill out the form above or reach out directly. I look forward to hearing about your project!</p>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </section>

    <!--- ADD FOOTER ----------------------->
    {{ $footerTemplate:= site.Params.footer.template | default "footer.html" }}
    {{- partial $footerTemplate . -}}
    
    <!--- ADD CHATBOT ----------------------->
    {{ partial "chatbot.html" . }}

    <!--- ADD COMMON SCRIPTS --------------->
    {{ partial "scripts.html" . }}
    {{- partial "misc/support.html" . -}}

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('contact-page-form');
        const statusEl = document.getElementById('contact-status');
        
        // Get CRM URL from chatbot config
        const crmApiUrl = window.ChatbotConfig ? window.ChatbotConfig.crmApiUrl : 'http://localhost:3000';
        
        form.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = {
                name: document.getElementById('contact-name').value,
                email: document.getElementById('contact-email').value,
                company: document.getElementById('contact-company').value,
                phone: document.getElementById('contact-phone').value,
                subject: document.getElementById('contact-subject').value,
                message: document.getElementById('contact-message').value
            };
            
            if (!formData.name || !formData.email || !formData.subject || !formData.message) {
                showStatus('Please fill in all required fields.', 'danger');
                return;
            }
            
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(formData.email)) {
                showStatus('Please enter a valid email address.', 'danger');
                return;
            }
            
            const submitBtn = document.getElementById('contact-submit');
            const originalHtml = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Sending...';
            submitBtn.disabled = true;
            showStatus('Sending your message...', 'info');
            
            try {
                const response = await fetch(`${crmApiUrl}/api/leads`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData),
                    signal: AbortSignal.timeout(10000)
                });
                
                if (response.ok) {
                    const result = await response.json();
                    form.reset();
                    showStatus(`‚úÖ Message sent! Reference ID: ${result.data.reference_id}. You'll receive a response within 24 hours.`, 'success');
                    
                    // Scroll to success message
                    statusEl.scrollIntoView({ behavior: 'smooth', block: 'center' });
                } else {
                    throw new Error('CRM API error');
                }
            } catch (error) {
                console.warn('CRM unavailable, using mailto fallback');
                
                // Fallback to mailto
                const emailBody = `Hi Corey,

I'm reaching out regarding: ${getSubjectDisplayName(formData.subject)}

Contact Information:
Name: ${formData.name}
Email: ${formData.email}
${formData.company ? `Company: ${formData.company}\n` : ''}${formData.phone ? `Phone: ${formData.phone}\n` : ''}

Message:
${formData.message}

Best regards,
${formData.name}

---
Sent via 200rx.com contact page
${new Date().toLocaleString()}`;

                const mailtoLink = `mailto:Ray@200rx.com?subject=${encodeURIComponent(`Contact Form: ${getSubjectDisplayName(formData.subject)}`)}&body=${encodeURIComponent(emailBody)}`;
                window.location.href = mailtoLink;
                
                showStatus('Your email client should open with a pre-filled message.', 'warning');
                form.reset();
            } finally {
                submitBtn.innerHTML = originalHtml;
                submitBtn.disabled = false;
            }
        });
        
        function showStatus(message, type) {
            const colors = {
                success: 'text-success',
                danger: 'text-danger',
                info: 'text-info',
                warning: 'text-warning'
            };
            
            statusEl.textContent = message;
            statusEl.className = `mt-3 fw-bold ${colors[type] || 'text-muted'}`;
        }
        
        function getSubjectDisplayName(subject) {
            const map = {
                'job-opportunity': 'Job Opportunity',
                'consultation': 'Technical Consultation',
                'project-collaboration': 'Project Collaboration',
                'networking': 'Professional Networking',
                'speaking': 'Speaking Engagement',
                'other': 'General Inquiry'
            };
            return map[subject] || 'Contact Request';
        }

        // Add focus effects to form elements
        const formElements = document.querySelectorAll('.form-control, .form-select');
        formElements.forEach(element => {
            element.addEventListener('focus', function() {
                this.parentElement.classList.add('focused');
            });
            element.addEventListener('blur', function() {
                this.parentElement.classList.remove('focused');
            });
        });
    });
    </script>

    <style>
    /* Theme-aware background for contact section */
    .section-holder.bg-dimmed {
        background-color: #f8fafc !important; /* Light background for light mode */
    }
    
    html[data-theme='dark'] .section-holder.bg-dimmed {
        background-color: #1a365d !important; /* Dark background for dark mode */
    }
    
    /* Contact intro text styling for better contrast - Higher specificity */
    .section-holder.bg-dimmed .contact-intro-text {
        color: #1e293b !important; /* Dark slate for light mode */
    }
    
    html[data-theme='dark'] .section-holder.bg-dimmed .contact-intro-text {
        color: #cbd5e1 !important; /* Light slate for dark mode */
    }
    
    /* Custom focus effects */
    .focused .form-label {
        color: var(--bs-primary) !important;
    }
    
    .form-control:focus, .form-select:focus {
        border-color: var(--bs-primary);
        box-shadow: 0 0 0 0.2rem rgba(var(--bs-primary-rgb), 0.25);
    }
    
    /* Hover effects for buttons */
    .btn:hover {
        transform: translateY(-1px);
        transition: all 0.2s ease;
    }
    
    /* Card hover effects */
    .card {
        transition: all 0.3s ease;
    }
    
    .card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 20px rgba(0,0,0,0.15) !important;
    }
    
    /* Mobile responsiveness */
    @media (max-width: 768px) {
        .section-holder {
            padding-top: 80px !important;
        }
        
        .card-body {
            padding: 1.5rem !important;
        }
        
        .btn-lg {
            font-size: 1rem;
            padding: 0.75rem 1.5rem;
        }
    }
    </style>
  </body>
</html>
