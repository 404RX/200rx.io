<!DOCTYPE html>
<html lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <title>Automation</title>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />

<link rel="stylesheet" href="/application.8fa182ad5087e81caf2bf29b5296bc6afa93de080155786a15ef933ca8c2dcf1.css" integrity="sha256-j6GCrVCH6ByvK/KbUpa8avqT3ggBVXhqFe&#43;TPKjC3PE=" />






<link rel="alternate" type="application/rss+xml" href="http://localhost:1313/tags/automation/index.xml" title="Ray Miller - IT Infrastructure Specialist [DEV]">








<meta property="og:title" content="Ray Miller - IT Infrastructure Specialist [DEV]"/>
<meta property="og:type" content="website"/>
<meta property="og:description" content=""/>
<meta property="og:image" content="/images/author/CM1.png">
<meta property="og:url" content="http://localhost:1313/">

     

    





    <script integrity="sha256-DO4ugzEwhTW1Id1UIWn0gUJWaebCYOypeTit6LW4QB4=">
     let theme = localStorage.getItem('theme-scheme') || localStorage.getItem('darkmode:color-scheme') || 'light'
if (theme === 'system') {
  if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
    theme = 'dark'
  } else {
    theme = 'light'
  }
}
document.documentElement.setAttribute('data-theme', theme)

    </script>
    
  </head>
<body class="type-tags kind-term" data-bs-spy="scroll" data-bs-target="#TableOfContents" data-bs-offset="80">
  <div class="container-fluid bg-secondary wrapper">
    
    
    
    <nav class="navbar navbar-expand-xl top-navbar shadow " id="top-navbar">
  <div class="container">
    
    <button class="navbar-toggler navbar-light" id="sidebar-toggler" type="button">
      <i data-feather="sidebar"></i>
    </button>
    
    <a class="navbar-brand" href="/">Ray Miller - IT Infrastructure Specialist [DEV]</a>
    <button
      class="navbar-toggler navbar-light"
      id="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#top-nav-items"
      aria-label="menu"
    >
      <i data-feather="menu"></i>
    </button>

    <div class="collapse navbar-collapse dynamic-navbar" id="top-nav-items">
      <ul class="nav navbar-nav ms-auto">
        <li class="nav-item">
          <a class="nav-link" href="/#home">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/#about">About</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/#skills">Skills</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/#experiences">Experience</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/#education">Education</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/#projects">Projects</a>
        </li>
        
          <li class="nav-item">
            <a class="nav-link" id="blog-link" href="/posts">Blog</a>
          </li>
        
        
            
              <li class="nav-item">
                <a class="nav-link" href="/services">Services</a>
              </li>
            
        
            
              <li class="nav-item">
                <a class="nav-link" href="/contact">Contact</a>
              </li>
            
        
        
        
          



  
  


<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle"  href="#" id="themeSelector" role="button"
  data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
  <img id="navbar-theme-icon-svg" class="theme-icon" src="/icons/moon-svgrepo-com.svg" width=20 alt="Dark Theme">
</a>
<div id="themeMenu" class="dropdown-menu dropdown-menu-icons-only" aria-labelledby="themeSelector">
  
  <a class="dropdown-item nav-link" href="#" data-scheme="light">
    <img class="theme-icon" src="/icons/sun-svgrepo-com.svg" width=20 alt="Light Theme">
  </a>
  
  
  <a class="dropdown-item nav-link" href="#" data-scheme="dark">
    <img class="theme-icon" src="/icons/moon-svgrepo-com.svg" width=20 alt="Dark Theme">
  </a>
  
  
  <a class="dropdown-item nav-link" href="#" data-scheme="system">
    <img class="theme-icon" src="/icons/computer-svgrepo-com.svg" width=20 alt="System Theme">
  </a>
  
</div>
</li>

        
      </ul>
    </div>
  </div>
</nav>


    
    
  
  

  <section class="sidebar-section" id="sidebar-section">
    <div class="sidebar-holder">
      <div class="sidebar" id="sidebar">
        <form class="mx-auto" method="get" action="/search">
          <input type="text" name="keyword" value="" placeholder="Search" data-search="" id="search-box" />
        </form>
        <div class="sidebar-tree">
          <ul class="tree" id="tree">
            <li id="list-heading"><a href="/tags" data-filter="all">Tags</a></li>
            <div class="subtree taxonomy-terms">
              
              



  
  
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/active-directory/" data-taxonomy-term="active-directory"><span class="taxonomy-label">Active-Directory</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/ai/" data-taxonomy-term="ai"><span class="taxonomy-label">AI</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term active" href="http://localhost:1313/tags/automation/" data-taxonomy-term="automation"><span class="taxonomy-label">Automation</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/azure/" data-taxonomy-term="azure"><span class="taxonomy-label">Azure</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/crisis-management/" data-taxonomy-term="crisis-management"><span class="taxonomy-label">Crisis-Management</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/emergency/" data-taxonomy-term="emergency"><span class="taxonomy-label">Emergency</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/hugo/" data-taxonomy-term="hugo"><span class="taxonomy-label">Hugo</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/infrastructure/" data-taxonomy-term="infrastructure"><span class="taxonomy-label">Infrastructure</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/intro/" data-taxonomy-term="intro"><span class="taxonomy-label">Intro</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/it-operations/" data-taxonomy-term="it-operations"><span class="taxonomy-label">IT Operations</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/javascript/" data-taxonomy-term="javascript"><span class="taxonomy-label">JavaScript</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/monitoring/" data-taxonomy-term="monitoring"><span class="taxonomy-label">Monitoring</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/performance/" data-taxonomy-term="performance"><span class="taxonomy-label">Performance</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/powershell/" data-taxonomy-term="powershell"><span class="taxonomy-label">Powershell</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/python/" data-taxonomy-term="python"><span class="taxonomy-label">Python</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/scripting/" data-taxonomy-term="scripting"><span class="taxonomy-label">Scripting</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/security/" data-taxonomy-term="security"><span class="taxonomy-label">Security</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/static-site/" data-taxonomy-term="static-site"><span class="taxonomy-label">Static Site</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/support/" data-taxonomy-term="support"><span class="taxonomy-label">Support</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/trends/" data-taxonomy-term="trends"><span class="taxonomy-label">Trends</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/troubleshooting/" data-taxonomy-term="troubleshooting"><span class="taxonomy-label">Troubleshooting</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/tutorial/" data-taxonomy-term="tutorial"><span class="taxonomy-label">Tutorial</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/vmware/" data-taxonomy-term="vmware"><span class="taxonomy-label">Vmware</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/web-development/" data-taxonomy-term="web-development"><span class="taxonomy-label">Web Development</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/welcome/" data-taxonomy-term="welcome"><span class="taxonomy-label">Welcome</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/windows-server/" data-taxonomy-term="windows-server"><span class="taxonomy-label">Windows-Server</span></a></li>
        
  


            </div>
          </ul>
        </div>
      </div>
    </div>
  </section>

    
<section class="content-section" id="content-section">
  <div class="content container-fluid" id="content">
    <div class="container-fluid post-card-holder" id="post-card-holder">
      
      
      
      
        
          <div class="post-card">
  <div class="card">
    <div class="card-head">
      <a href="/posts/ad-cleanup-automation/" class="post-card-link">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </a>
    </div>
    <div class="card-body">
      <a href="/posts/ad-cleanup-automation/" class="post-card-link">
        <h5 class="card-title">Active Directory Cleanup Automation with PowerShell</h5>
        <p class="card-text post-summary">Introduction Stale and unused objects in Active Directory not only clutter your environment but can also create security risks and provisioning errors. Automating cleanup ensures better hygiene and consistent identity lifecycle management. This guide walks through how to use PowerShell to audit and optionally remove inactive AD users and computers.
Core Principles 1. Identify Inactive Users and Computers # Users inactive for 90+ days $inactiveUsers = Get-ADUser -Filter * -Properties LastLogonDate | Where-Object { $_.Enabled -eq $true -and $_.LastLogonDate -lt (Get-Date).AddDays(-90) } # Computers inactive for 90+ days $inactiveComputers = Get-ADComputer -Filter * -Properties LastLogonDate | Where-Object { $_.Enabled -eq $true -and $_.LastLogonDate -lt (Get-Date).AddDays(-90) } 🔍 Use -SearchBase to narrow to a specific OU
Example: -SearchBase &quot;OU=Workstations,DC=corp,DC=domain,DC=com&quot;
</p>
      </a>
      
    </div>
    <div class="card-footer">
      <span class="float-start">
          Monday, March 18, 2024
          </span>
      <a
      href="/posts/ad-cleanup-automation/"
      class="float-end btn btn-outline-info btn-sm">Read</a>
    </div>
  </div>
</div>

        
      
        
          <div class="post-card">
  <div class="card">
    <div class="card-head">
      <a href="/posts/remote-system-healthcheckpowershell/" class="post-card-link">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </a>
    </div>
    <div class="card-body">
      <a href="/posts/remote-system-healthcheckpowershell/" class="post-card-link">
        <h5 class="card-title">Remote System Health Checks with PowerShell</h5>
        <p class="card-text post-summary">Introduction Ensuring system uptime and catching performance issues early is vital in any infrastructure. With PowerShell, you can automate system health checks across your environment, collect metrics, and act on anomalies before they impact operations.
This guide walks through a practical PowerShell script for remote system health monitoring, complete with optional test coverage using Pester.
Core Principles 1. Test System Health Remotely with WMI function Test-SystemHealth { param ( [string]$ComputerName ) $result = @{ ComputerName = $ComputerName Ping = $false CPU = $null Memory = $null DiskSpace = $null } if (Test-Connection -ComputerName $ComputerName -Count 2 -Quiet) { $result.Ping = $true try { $sys = Get-WmiObject -Class Win32_OperatingSystem -ComputerName $ComputerName $cpu = Get-WmiObject -Class Win32_Processor -ComputerName $ComputerName $disk = Get-WmiObject -Class Win32_LogicalDisk -ComputerName $ComputerName -Filter &#34;DriveType=3&#34; $result.CPU = [math]::Round($cpu.LoadPercentage, 2) $result.Memory = [math]::Round((($sys.TotalVisibleMemorySize - $sys.FreePhysicalMemory) / $sys.TotalVisibleMemorySize) * 100, 2) $result.DiskSpace = @() foreach ($d in $disk) { $usedPercent = [math]::Round((($d.Size - $d.FreeSpace) / $d.Size) * 100, 2) $result.DiskSpace += @{ Drive = $d.DeviceID; UsedPercent = $usedPercent } } } catch { Write-Warning &#34;Unable to gather metrics from $ComputerName&#34; } } return $result } # Example usage $computers = Get-Content -Path &#34;.\computers.txt&#34; $healthReport = $computers | ForEach-Object { Test-SystemHealth -ComputerName $_ } $healthReport | ConvertTo-Json | Out-File &#34;.\HealthReport.json&#34; ### 2. Testing Strategy with Pester ```powershell Describe &#39;Test-SystemHealth&#39; { It &#39;Should return a result object with expected keys&#39; { $mockResult = Test-SystemHealth -ComputerName &#34;localhost&#34; $mockResult | Should -Not -BeNullOrEmpty $mockResult | Should -HaveProperty &#39;ComputerName&#39; $mockResult | Should -HaveProperty &#39;Ping&#39; $mockResult | Should -HaveProperty &#39;CPU&#39; $mockResult | Should -HaveProperty &#39;Memory&#39; $mockResult | Should -HaveProperty &#39;DiskSpace&#39; } It &#39;Should show Ping as true for localhost&#39; { $mockResult = Test-SystemHealth -ComputerName &#34;localhost&#34; $mockResult.Ping | Should -BeTrue } } </p>
      </a>
      
    </div>
    <div class="card-footer">
      <span class="float-start">
          Sunday, March 10, 2024
          </span>
      <a
      href="/posts/remote-system-healthcheckpowershell/"
      class="float-end btn btn-outline-info btn-sm">Read</a>
    </div>
  </div>
</div>

        
      
        
          <div class="post-card">
  <div class="card">
    <div class="card-head">
      <a href="/services/automation-as-a-service/" class="post-card-link">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </a>
    </div>
    <div class="card-body">
      <a href="/services/automation-as-a-service/" class="post-card-link">
        <h5 class="card-title">Automation as a Service</h5>
        <p class="card-text post-summary">Automation as a Service Transform your repetitive IT tasks into automated workflows that save time, reduce errors, and free your team for strategic work.
What You Get Custom Script Development PowerShell/Python scripts tailored to your environment API integrations connecting your systems Scheduled automation for routine tasks Error handling and logging for reliability System Monitoring &amp; Alerting Proactive monitoring of critical systems Custom dashboards with real-time metrics Intelligent alerting to prevent issues Performance trend analysis Compliance Automation STIG/CIS standard implementation Automated remediation scripts Compliance reporting and documentation Audit preparation support Typical ROI 20-40 hours saved per week per implementation 50% reduction in manual errors 30% faster incident response 85% less time spent on audit preparation Technologies Used PowerShell (5.1/7.x) Python (3.x with libraries) REST APIs and web services Task schedulers and automation platforms Monitoring tools (PRTG, Nagios, custom) Deliverables Custom automation scripts with full documentation Installation and configuration guides Monitoring dashboards and alerting setup Training materials for your team Maintenance procedures and support documentation Engagement Options Quick Win Package (1-2 weeks) Automate 1-3 critical processes Immediate ROI demonstration Perfect for proof of concept Transformation Package (1-3 months) Comprehensive process automation Multiple system integration Significant efficiency gains Enterprise Package (3-6 months) Full-scale automation program Organization-wide improvements Complete process transformation Ready to eliminate manual processes? Contact me to discuss your automation needs and get a custom proposal.
</p>
      </a>
      
    </div>
    <div class="card-footer">
      <span class="float-start">
          Monday, January 1, 2024
          </span>
      <a
      href="/services/automation-as-a-service/"
      class="float-end btn btn-outline-info btn-sm">Read</a>
    </div>
  </div>
</div>

        
      
    </div>
    <div class="paginator">
      
    </div>
  </div>
</section>

    

  </div>

  
  












  
  
    
  

  
  
    
  

  
  

  
  
    
    
  

  
  
  

  
  
  

  <footer id="footer" class="container-fluid text-center align-content-center footer pb-2">
    <div class="container pt-5">
      <div class="row text-start">
        
        <div class="col-md-4 col-sm-12">
          <h5>Navigation</h5>
          
          <ul>
            
            <li class="nav-item">
              <a class="smooth-scroll" href="http://localhost:1313/#about">About</a>
            </li>
            <li class="nav-item">
              <a class="smooth-scroll" href="http://localhost:1313/#skills">Skills</a>
            </li>
            <li class="nav-item">
              <a class="smooth-scroll" href="http://localhost:1313/#experiences">Experience</a>
            </li>
            <li class="nav-item">
              <a class="smooth-scroll" href="http://localhost:1313/#projects">Projects</a>
            </li>
            
            <li class="nav-item">
              <a href="http://localhost:1313/posts">Blog</a>
            </li>
            
            
              
                
              
                
              
            
          </ul>
          
        </div>
        
        
        <div class="col-md-4 col-sm-12">
          <h5>Contact me:</h5>
          <ul>
            
              
                <li><a href=mailto:ray@200rx.com target="_blank" rel="noopener">
                  <span><i class="fas fa-envelope"></i></span> <span>ray@200rx.com</span>
                </a></li>
              
            
              
                <li><span>Location: </span> <span>New York, NY</span></li>
              
            
              
                <li><span>Website: </span> <span>https://200rx.com</span></li>
              
            
          </ul>
        </div>
        
        
        
          
          <div class="col-md-4 col-sm-12">
            <p>Stay up to date with email notification</p>
            
              <form method='post' action='https://blogtrottr.com'>
              <div class="form-group">
              <input type='email' class="form-control" name='btr_email' placeholder="Enter email"/><br />
              <input type='hidden' name='btr_url' value='http://localhost:1313//index.xml' />
              <input type='hidden' name='schedule_type' value='1' />
              <small id="emailHelp" class="form-text text-muted">By entering your email address, you agree to receive the newsletter of this website.</small>
              <button type="submit" class="btn btn-info"> Submit </button>
              </div>
              </form>
            
          </div>
        
      </div>
    </div>
    
    
    <hr />
    <div class="container">
      <div class="row text-start">
        <div class="col-md-4">
          <a id="theme" href="https://github.com/hugo-toha/toha" target="_blank" rel="noopener">
            <img src="/images/theme-logo.png" alt="Toha Theme Logo">
          </a>
        </div>
        <div class="col-md-4 text-center">© 2025 Copyright.</div>
        <div class="col-md-4 text-end">
          <a id="hugo" href="https://gohugo.io/" target="_blank" rel="noopener">Powered by
          <img
            src="/images/hugo-logo.svg"
            alt="Hugo Logo"
            height="18"
          />
          </a>
        </div>
      </div>
    </div>
    
  </footer>

  
<script>

window.ChatbotConfig = (function() {
    const hostname = window.location.hostname;
    const isDevelopment = hostname.includes('dev') || 
                         hostname.includes('localhost') || 
                         hostname.includes('127.0.0.1') ||
                         hostname.includes('netlify.app');
    
    if (isDevelopment) {
        return {
            apiUrl: 'https://portfolio-ai-development.up.railway.app',
            crmApiUrl: 'https://200rxio-crm-development.up.railway.app',
            crmApiUrlFallback: 'http://localhost:3000',
            retryAttempts: 5, 
            timeout: 15000,   
            environment: 'development'
        };
    } else {
        return {
            apiUrl: 'https://portfolio-ai-backend-1zyj.onrender.com',
            crmApiUrl: 'https://200rxio-crm-production.up.railway.app',
            crmApiUrlFallback: 'http://localhost:3000',
            retryAttempts: 3,
            timeout: 10000,
            environment: 'production'
        };
    }
})();

class ProfessionalChatbot {
    constructor() {
        this.isOpen = false;
        this.isContactFormOpen = false;
        this.messages = [];
        this.sessionId = this.generateSessionId();
        this.apiUrl = window.ChatbotConfig.apiUrl;
        this.crmApiUrl = window.ChatbotConfig.crmApiUrl;
        this.retryAttempts = window.ChatbotConfig.retryAttempts;
        this.timeout = window.ChatbotConfig.timeout;
        this.isTyping = false;
        this.init();
    }

    generateSessionId() {
        return 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
    }

    async init() {
        this.createChatInterface();
        this.bindEvents();
        await this.checkBackendHealth();
        await this.checkCrmHealth();
    }

    async checkBackendHealth() {
        const statusEl = document.getElementById('connection-status');
        try {
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), 5000);
            
            const response = await fetch(`${this.apiUrl}/api/health`, {
                method: 'GET',
                headers: { 'Content-Type': 'application/json' },
                signal: controller.signal
            });
            
            clearTimeout(timeoutId);
            
            if (response.ok) {
                const health = await response.json();
                statusEl.textContent = health.ai_available ? '🤖 AI Ready' : '🟡 Enhanced Ready';
                statusEl.style.color = health.ai_available ? '#28a745' : '#ffc107';
            } else {
                throw new Error(`Backend unhealthy: ${response.status}`);
            }
        } catch (error) {
            statusEl.textContent = '🔴 AI Offline';
            statusEl.style.color = '#dc3545';
        }
    }

    async checkCrmHealth() {
        const crmStatusEl = document.getElementById('crm-status');
        
        
        const urlsToTry = [
            this.crmApiUrl,
            window.ChatbotConfig.crmApiUrlFallback
        ];
        
        for (const url of urlsToTry) {
            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 5000);
                
                const response = await fetch(`${url}/api/health`, {
                    method: 'GET',
                    headers: { 'Content-Type': 'application/json' },
                    signal: controller.signal
                });
                
                clearTimeout(timeoutId);
                
                if (response.ok) {
                    
                    this.crmApiUrl = url;
                    crmStatusEl.textContent = url.includes('localhost') ? '🏠 CRM Local' : '📊 CRM Active';
                    crmStatusEl.style.color = '#28a745';
                    return;
                }
            } catch (error) {
                console.warn(`CRM health check failed for ${url}:`, error.message);
            }
        }
        
        
        crmStatusEl.textContent = '📧 Email Mode';
        crmStatusEl.style.color = '#ffc107';
    }

    createChatInterface() {
        const launcher = document.createElement('div');
        launcher.id = 'chat-launcher';
        launcher.innerHTML = `
            <div style="display: flex; align-items: center; gap: 8px;">
                <span style="font-size: 18px;">🤖</span>
                <span>Ask about my experience</span>
            </div>
        `;
        launcher.style.cssText = `
            position: fixed; bottom: 20px; right: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; padding: 12px 16px; border-radius: 25px; cursor: pointer;
            z-index: 1000; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-size: 14px; font-weight: 500; box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease; border: none; min-width: 200px; text-align: center;
        `;

        const chatPanel = document.createElement('div');
        chatPanel.id = 'chat-panel';
        chatPanel.style.cssText = `
            position: fixed; top: 0; right: -400px; width: 400px; height: 100vh; background: #ffffff;
            border-left: 1px solid #e1e5e9; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            box-shadow: -4px 0 20px rgba(0, 0, 0, 0.1); z-index: 999999; display: flex; flex-direction: column;
            transition: right 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        `;

        chatPanel.innerHTML = `
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 16px 20px; display: flex; justify-content: space-between; align-items: center; min-height: 60px; box-sizing: border-box;">
                <div>
                    <div style="font-weight: 600; font-size: 16px; margin-bottom: 4px;">Corey's AI Assistant</div>
                    <div style="font-size: 12px; opacity: 0.9;">Powered by OpenAI</div>
                </div>
                <button id="chat-close" style="background: rgba(255,255,255,0.2); border: none; color: white; width: 32px; height: 32px; border-radius: 50%; cursor: pointer; font-size: 18px; display: flex; align-items: center; justify-content: center;">&times;</button>
            </div>
            
            <div id="chat-messages" style="flex: 1; overflow-y: auto; padding: 20px; background: #f8f9fa;"></div>
            
            <div style="padding: 16px 20px; border-top: 1px solid #e1e5e9; background: white;">
                <div style="display: flex; gap: 8px; align-items: flex-end;">
                    <textarea id="chat-input" placeholder="Ask me about Corey's experience..." 
                           style="flex: 1; padding: 12px 16px; border: 2px solid #e1e5e9; border-radius: 12px; outline: none; font-size: 14px; resize: none; min-height: 44px; max-height: 120px; font-family: inherit;"
                           rows="1" maxlength="1000"></textarea>
                    <button id="send-button" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; color: white; width: 44px; height: 44px; border-radius: 12px; cursor: pointer; display: flex; align-items: center; justify-content: center;">
                        <span style="font-size: 16px; transform: rotate(-45deg);">➤</span>
                    </button>
                </div>
                <div style="display: flex; gap: 8px; margin-top: 8px; align-items: center; flex-wrap: wrap;">
                    <div id="connection-status" style="font-size: 11px; color: #6c757d; flex: 1;">Checking AI...</div>
                    <div id="crm-status" style="font-size: 11px; color: #6c757d; flex: 1;">Checking CRM...</div>
                    <button id="contact-trigger" style="background: transparent; border: 1px solid #667eea; color: #667eea; padding: 6px 12px; border-radius: 6px; font-size: 11px; cursor: pointer;">Contact Corey</button>
                </div>
            </div>
            
            <div id="contact-form" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: white; transform: translateX(100%); transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1); z-index: 10;">
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 16px 20px; display: flex; justify-content: space-between; align-items: center; min-height: 60px; box-sizing: border-box;">
                    <div>
                        <div style="font-weight: 600; font-size: 16px; margin-bottom: 4px;">Professional Contact Form</div>
                        <div style="font-size: 12px; opacity: 0.9;">Powered by CRM • Instant notifications</div>
                    </div>
                    <button id="contact-back" style="background: rgba(255,255,255,0.2); border: none; color: white; width: 32px; height: 32px; border-radius: 50%; cursor: pointer; font-size: 18px;">←</button>
                </div>
                
                <div style="padding: 20px; height: calc(100% - 92px); overflow-y: auto;">
                    <form id="contact-form-data" style="display: flex; flex-direction: column; gap: 16px;">
                        <div>
                            <label style="display: block; margin-bottom: 6px; font-weight: 500; color: #2c3e50;">Your Name *</label>
                            <input type="text" id="contact-name" required style="width: 100%; padding: 12px; border: 2px solid #e1e5e9; border-radius: 8px; font-size: 14px; outline: none; box-sizing: border-box;" placeholder="John Smith">
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 6px; font-weight: 500; color: #2c3e50;">Email Address *</label>
                            <input type="email" id="contact-email" required style="width: 100%; padding: 12px; border: 2px solid #e1e5e9; border-radius: 8px; font-size: 14px; outline: none; box-sizing: border-box;" placeholder="john@company.com">
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 6px; font-weight: 500; color: #2c3e50;">Company/Organization</label>
                            <input type="text" id="contact-company" style="width: 100%; padding: 12px; border: 2px solid #e1e5e9; border-radius: 8px; font-size: 14px; outline: none; box-sizing: border-box;" placeholder="Your Company">
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 6px; font-weight: 500; color: #2c3e50;">Phone Number</label>
                            <input type="tel" id="contact-phone" style="width: 100%; padding: 12px; border: 2px solid #e1e5e9; border-radius: 8px; font-size: 14px; outline: none; box-sizing: border-box;" placeholder="(555) 123-4567">
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 6px; font-weight: 500; color: #2c3e50;">Subject *</label>
                            <select id="contact-subject" required style="width: 100%; padding: 12px; border: 2px solid #e1e5e9; border-radius: 8px; font-size: 14px; outline: none; box-sizing: border-box; background: white;">
                                <option value="">Select a topic...</option>
                                <option value="job-opportunity">Job Opportunity</option>
                                <option value="consultation">Technical Consultation</option>
                                <option value="project-collaboration">Project Collaboration</option>
                                <option value="networking">Professional Networking</option>
                                <option value="speaking">Speaking Engagement</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 6px; font-weight: 500; color: #2c3e50;">Message *</label>
                            <textarea id="contact-message" required rows="4" style="width: 100%; padding: 12px; border: 2px solid #e1e5e9; border-radius: 8px; font-size: 14px; outline: none; resize: vertical; min-height: 100px; font-family: inherit; box-sizing: border-box;" placeholder="Tell Corey about your opportunity, project, or how you'd like to connect..."></textarea>
                        </div>
                        
                        <div style="margin-top: 8px;">
                            <button type="submit" id="contact-submit" style="width: 100%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 14px; border-radius: 8px; font-size: 16px; font-weight: 500; cursor: pointer;">Send Message to Corey</button>
                        </div>
                        
                        <div style="text-align: center; margin-top: 16px; padding-top: 16px; border-top: 1px solid #e1e5e9;">
                            <p style="margin: 0 0 8px 0; font-size: 13px; color: #6c757d;">Or reach out directly:</p>
                            <div style="display: flex; gap: 12px; justify-content: center; flex-wrap: wrap;">
                                <a href="mailto:Ray@200rx.com" style="color: #667eea; text-decoration: none; font-size: 13px; font-weight: 500;">📧 Ray@200rx.com</a>
                                <a href="https://www.linkedin.com/in/coreyvmiller/" target="_blank" style="color: #667eea; text-decoration: none; font-size: 13px; font-weight: 500;">💼 LinkedIn</a>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        `;

        document.body.appendChild(chatPanel);
        document.body.appendChild(launcher);
        this.addStyles();
    }

    addStyles() {
        const style = document.createElement('style');
        style.textContent = `
            @keyframes typing { 0%, 60%, 100% { transform: translateY(0); opacity: 0.4; } 30% { transform: translateY(-10px); opacity: 1; } }
            
            /* Mobile-specific chatbot styles */
            @media (max-width: 768px) { 
                #chat-launcher {
                    bottom: calc(15px + env(safe-area-inset-bottom)) !important;
                    right: 15px !important;
                    min-width: 180px !important;
                    padding: 10px 14px !important;
                    font-size: 13px !important;
                }
                
                #chat-panel { 
                    width: 100vw !important; 
                    right: -100vw !important;
                    height: 100vh !important;
                    height: 100dvh !important; /* Dynamic viewport height for mobile */
                    top: 0 !important;
                    padding-bottom: env(safe-area-inset-bottom) !important;
                    box-sizing: border-box !important;
                } 
                
                #chat-panel.open { 
                    right: 0 !important; 
                }
                
                #chat-messages {
                    padding: 15px !important;
                    padding-bottom: calc(15px + env(safe-area-inset-bottom)) !important;
                }
                
                #chat-input {
                    font-size: 16px !important; /* Prevents zoom on iOS */
                }
                
                /* Specific input area positioning for iOS */
                #chat-panel > div:last-child {
                    padding-bottom: calc(16px + env(safe-area-inset-bottom)) !important;
                    margin-bottom: env(safe-area-inset-bottom) !important;
                }
            }
            
            /* iOS Safari specific fixes */
            @supports (-webkit-touch-callout: none) {
                @media (max-width: 768px) {
                    #chat-panel {
                        height: calc(100vh - env(safe-area-inset-bottom)) !important;
                        height: calc(100dvh - env(safe-area-inset-bottom)) !important;
                    }
                    
                    #chat-launcher {
                        bottom: calc(25px + env(safe-area-inset-bottom)) !important;
                    }
                    
                    /* Ensure input area is above iOS URL bar */
                    #chat-panel > div:last-child {
                        position: fixed !important;
                        bottom: calc(50px + env(safe-area-inset-bottom)) !important; /* Positioned closer to URL bar */
                        left: 0 !important;
                        right: 0 !important;
                        width: 100% !important;
                        background: white !important;
                        border-top: 1px solid #e1e5e9 !important;
                        margin-bottom: 0 !important;
                        padding: 12px 16px calc(12px + env(safe-area-inset-bottom)) 16px !important;
                        box-shadow: 0 -2px 10px rgba(0,0,0,0.1) !important;
                        z-index: 1000001 !important;
                        max-height: 120px !important;
                        min-height: 80px !important;
                    }
                    
                    /* Smaller iPhone models (iPhone SE, etc.) */
                    @media screen and (max-height: 667px) {
                        #chat-panel > div:last-child {
                            bottom: calc(40px + env(safe-area-inset-bottom)) !important;
                            padding: 10px 16px calc(10px + env(safe-area-inset-bottom)) 16px !important;
                        }
                    }
                    
                    /* Larger iPhone models */
                    @media screen and (min-height: 812px) {
                        #chat-panel > div:last-child {
                            bottom: calc(60px + env(safe-area-inset-bottom)) !important;
                        }
                    }
                    
                    /* Adjust messages area to account for fixed input */
                    #chat-messages {
                        padding-bottom: calc(100px + env(safe-area-inset-bottom)) !important;
                    }
                }
            }
            
            /* Enhanced touch targets for mobile */
            @media (max-width: 768px) {
                #chat-launcher, #chat-close, #send-button, #contact-trigger, #contact-back {
                    touch-action: manipulation;
                    -webkit-touch-callout: none;
                    -webkit-user-select: none;
                    user-select: none;
                }
            }
        `;
        document.head.appendChild(style);
    }

    bindEvents() {
        
        this.addClickHandler('chat-launcher', () => this.toggleChat());
        this.addClickHandler('chat-close', () => this.toggleChat());
        this.addClickHandler('send-button', () => this.sendMessage());
        this.addClickHandler('contact-trigger', () => this.showContactForm());
        this.addClickHandler('contact-back', () => this.hideContactForm());
        
        document.getElementById('contact-form-data').addEventListener('submit', (e) => this.handleContactSubmit(e));
        
        document.getElementById('chat-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey && !this.isTyping) {
                e.preventDefault();
                this.sendMessage();
            }
        });
    }

    addClickHandler(elementId, handler) {
        const element = document.getElementById(elementId);
        if (!element) return;
        
        
        element.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            handler();
        });
        
        
        let touchStarted = false;
        element.addEventListener('touchstart', (e) => {
            touchStarted = true;
            setTimeout(() => { touchStarted = false; }, 300);
        });
        
        element.addEventListener('touchend', (e) => {
            if (touchStarted) {
                e.preventDefault();
                e.stopPropagation();
                handler();
                touchStarted = false;
            }
        });
    }

    showContactForm() {
        document.getElementById('contact-form').style.transform = 'translateX(0)';
        this.isContactFormOpen = true;
        setTimeout(() => document.getElementById('contact-name').focus(), 300);
    }

    hideContactForm() {
        document.getElementById('contact-form').style.transform = 'translateX(100%)';
        this.isContactFormOpen = false;
    }

    async handleContactSubmit(e) {
        e.preventDefault();
        
        
        const nameEl = document.getElementById('contact-name');
        const emailEl = document.getElementById('contact-email');
        const companyEl = document.getElementById('contact-company');
        const phoneEl = document.getElementById('contact-phone');
        const subjectEl = document.getElementById('contact-subject');
        const messageEl = document.getElementById('contact-message');
        
        if (!nameEl || !emailEl || !subjectEl || !messageEl) {
            alert('Form elements not found. Please try closing and reopening the contact form.');
            return;
        }
        
        const formData = {
            name: nameEl.value.trim(),
            email: emailEl.value.trim(),
            company: companyEl ? companyEl.value.trim() : '',
            phone: phoneEl ? phoneEl.value.trim() : '',
            subject: subjectEl.value.trim(),
            message: messageEl.value.trim()
        };
        
        
        console.log('Form Data Debug:', formData);
        console.log('Form Elements Found:', {
            name: !!document.getElementById('contact-name'),
            email: !!document.getElementById('contact-email'),
            subject: !!document.getElementById('contact-subject'),
            message: !!document.getElementById('contact-message')
        });
        
        
        if (!formData.name) {
            alert('Please enter your name.');
            document.getElementById('contact-name').focus();
            return;
        }
        
        if (!formData.email) {
            alert('Please enter your email address.');
            document.getElementById('contact-email').focus();
            return;
        }
        
        if (!formData.subject || formData.subject === "") {
            alert('Please select a subject from the dropdown.');
            document.getElementById('contact-subject').focus();
            return;
        }
        
        if (!formData.message) {
            alert('Please enter a message.');
            document.getElementById('contact-message').focus();
            return;
        }
        
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(formData.email)) {
            alert('Please enter a valid email address.');
            return;
        }
        
        const submitBtn = document.getElementById('contact-submit');
        submitBtn.textContent = 'Sending...';
        submitBtn.disabled = true;
        
        try {
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), 10000);
            
            const response = await fetch(`${this.crmApiUrl}/api/leads`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(formData),
                signal: controller.signal
            });
            
            clearTimeout(timeoutId);
            
            if (response.ok) {
                const result = await response.json();
                this.hideContactForm();
                this.addMessage('assistant', 
                    `✅ Thank you ${formData.name}! Your message has been received and assigned reference ID: ${result.data.reference_id}. 

Corey will review your ${this.getSubjectDisplayName(formData.subject)} inquiry and respond within 24 hours.

Priority Level: ${result.data.priority.toUpperCase()}
Lead Score: ${result.data.lead_score}/100`
                );
                
                document.getElementById('contact-form-data').reset();
                document.getElementById('crm-status').textContent = '✅ Lead Captured';
                document.getElementById('crm-status').style.color = '#28a745';
            } else {
                throw new Error(`CRM API error: ${response.status}`);
            }
        } catch (error) {
            console.warn('CRM unavailable, using mailto fallback');
            const emailBody = this.formatEmailBody(formData);
            const mailtoLink = `mailto:Ray@200rx.com?subject=${encodeURIComponent(`Contact Form: ${this.getSubjectDisplayName(formData.subject)}`)}&body=${encodeURIComponent(emailBody)}`;
            window.location.href = mailtoLink;
            
            this.hideContactForm();
            this.addMessage('assistant', `Thank you ${formData.name}! Your email client should open with a pre-filled message to Corey.`);
            document.getElementById('contact-form-data').reset();
        } finally {
            submitBtn.textContent = 'Send Message to Corey';
            submitBtn.disabled = false;
        }
    }

    getSubjectDisplayName(subject) {
        const map = {
            'job-opportunity': 'Job Opportunity',
            'consultation': 'Technical Consultation',
            'project-collaboration': 'Project Collaboration',
            'networking': 'Professional Networking',
            'speaking': 'Speaking Engagement',
            'other': 'General Inquiry'
        };
        return map[subject] || 'Contact Request';
    }

    formatEmailBody(formData) {
        return `Hi Corey,

I'm reaching out regarding: ${this.getSubjectDisplayName(formData.subject)}

Contact Information:
Name: ${formData.name}
Email: ${formData.email}
${formData.company ? `Company: ${formData.company}\n` : ''}${formData.phone ? `Phone: ${formData.phone}\n` : ''}

Message:
${formData.message}

Best regards,
${formData.name}

---
Sent via 200rx.com contact form
${new Date().toLocaleString()}`;
    }

    async toggleChat() {
        const chatPanel = document.getElementById('chat-panel');
        const launcher = document.getElementById('chat-launcher');
        
        this.isOpen = !this.isOpen;
        
        if (this.isOpen) {
            chatPanel.classList.add('open');
            chatPanel.style.right = '0';
            launcher.style.opacity = '0';
            launcher.style.visibility = 'hidden';
            
            
            if (window.innerWidth <= 768) {
                document.body.style.overflow = 'hidden';
            }
            
            if (this.messages.length === 0) {
                this.addMessage('assistant', "Hello! I'm Corey's AI assistant. I can provide detailed information about his professional background, technical expertise, and project experience. What would you like to know?");
            }
            
            setTimeout(() => {
                const chatInput = document.getElementById('chat-input');
                if (chatInput) {
                    chatInput.focus();
                    
                    if (window.innerWidth <= 768) {
                        chatInput.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }
            }, 300);
        } else {
            chatPanel.classList.remove('open');
            chatPanel.style.right = window.innerWidth <= 768 ? '-100vw' : '-400px';
            launcher.style.opacity = '1';
            launcher.style.visibility = 'visible';
            
            
            if (window.innerWidth <= 768) {
                document.body.style.overflow = '';
            }
        }
    }

    addMessage(sender, text, typing = false) {
        const container = document.getElementById('chat-messages');
        const div = document.createElement('div');
        const isUser = sender === 'user';
        
        div.style.cssText = `margin-bottom: 16px; display: flex; ${isUser ? 'justify-content: flex-end' : 'justify-content: flex-start'};`;
        
        const bubble = document.createElement('div');
        bubble.style.cssText = `
            max-width: 80%; padding: 12px 16px;
            border-radius: ${isUser ? '18px 18px 4px 18px' : '18px 18px 18px 4px'};
            background: ${isUser ? 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' : '#ffffff'};
            color: ${isUser ? 'white' : '#2c3e50'};
            border: ${isUser ? 'none' : '1px solid #e9ecef'};
            font-size: 14px; line-height: 1.5; white-space: pre-wrap; word-wrap: break-word;
        `;

        if (typing) {
            bubble.id = 'typing-indicator';
            bubble.innerHTML = '<div style="display: flex; gap: 4px;"><div style="width: 8px; height: 8px; border-radius: 50%; background: #6c757d; animation: typing 1.4s infinite;"></div><div style="width: 8px; height: 8px; border-radius: 50%; background: #6c757d; animation: typing 1.4s infinite 0.2s;"></div><div style="width: 8px; height: 8px; border-radius: 50%; background: #6c757d; animation: typing 1.4s infinite 0.4s;"></div></div>';
        } else {
            bubble.textContent = text;
            this.messages.push({ sender, text, timestamp: new Date().toISOString() });
        }
        
        div.appendChild(bubble);
        container.appendChild(div);
        container.scrollTop = container.scrollHeight;
    }

    async sendMessage() {
        const input = document.getElementById('chat-input');
        const message = input.value.trim();
        
        if (!message || this.isTyping) return;
        
        this.addMessage('user', message);
        input.value = '';
        
        this.addMessage('assistant', '', true);
        this.isTyping = true;
        
        try {
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), this.timeout);
            
            const response = await fetch(`${this.apiUrl}/api/chat`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ message, sessionId: this.sessionId }),
                signal: controller.signal
            });
            
            clearTimeout(timeoutId);
            
            document.getElementById('typing-indicator').parentElement.remove();
            this.isTyping = false;
            
            if (response.ok) {
                const data = await response.json();
                this.addMessage('assistant', data.response);
            } else {
                throw new Error(`HTTP ${response.status}`);
            }
        } catch (error) {
            document.getElementById('typing-indicator')?.parentElement?.remove();
            this.isTyping = false;
            this.addMessage('assistant', "I'm experiencing technical difficulties. Please contact Corey directly at Ray@200rx.com.");
        }
    }
}


document.addEventListener('DOMContentLoaded', () => {
    console.log('🚀 Initializing Professional AI Chatbot with CRM Integration...');
    const chatbot = new ProfessionalChatbot();
    
    
    let initialViewportHeight = window.innerHeight;
    
    window.addEventListener('resize', () => {
        if (window.innerWidth <= 768) {
            const chatPanel = document.getElementById('chat-panel');
            const currentHeight = window.innerHeight;
            
            
            if (Math.abs(currentHeight - initialViewportHeight) > 150) {
                if (chatPanel && chatbot.isOpen) {
                    
                    chatPanel.style.height = `${currentHeight}px`;
                    
                    
                    const inputArea = chatPanel.querySelector('div:last-child');
                    if (inputArea) {
                        inputArea.scrollIntoView({ behavior: 'smooth', block: 'end' });
                    }
                }
            }
        }
    });
    
    
    window.addEventListener('load', () => {
        const chatInput = document.getElementById('chat-input');
        if (chatInput) {
            chatInput.addEventListener('focus', () => {
                if (window.innerWidth <= 768) {
                    
                    setTimeout(() => {
                        const inputArea = document.querySelector('#chat-panel > div:last-child');
                        if (inputArea) {
                            
                            const viewportHeight = window.innerHeight;
                            const urlBarHeight = 44;
                            const keyboardBuffer = 20;
                            
                            
                            inputArea.style.bottom = `${urlBarHeight + keyboardBuffer}px`;
                            
                            
                            window.scrollTo(0, document.body.scrollHeight);
                        }
                    }, 300);
                }
            });
            
            
            chatInput.addEventListener('blur', () => {
                if (window.innerWidth <= 768) {
                    setTimeout(() => {
                        const inputArea = document.querySelector('#chat-panel > div:last-child');
                        if (inputArea) {
                            
                            inputArea.style.bottom = `calc(44px + env(safe-area-inset-bottom))`;
                        }
                    }, 300);
                }
            });
        }
    });
});
</script>
  
  <script src="/application.8a94b9a113db95215dc950bfe0c9d80b50010fb4bb9c6c3dce33f5960f31ac79.js" integrity="sha256-ipS5oRPblSFdyVC/4MnYC1ABD7S7nGw9zjP1lg8xrHk=" defer></script>

   
</body>
</html>
