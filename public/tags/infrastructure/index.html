<!DOCTYPE html>
<html lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <title>Infrastructure</title>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />

<link rel="stylesheet" href="/application.c6d771b4b54ea22d5b498c4b5aa63973ae39189231b4a54f661260b04b7b46b1.css" integrity="sha256-xtdxtLVOoi1bSYxLWqY5c645GJIxtKVPZhJgsEt7RrE=" />






<link rel="alternate" type="application/rss+xml" href="http://localhost:1313/tags/infrastructure/index.xml" title="Ray - Systems Administrator">








<meta property="og:title" content="Ray - Systems Administrator"/>
<meta property="og:type" content="website"/>
<meta property="og:description" content=""/>
<meta property="og:image" content="/images/author/self.png">
<meta property="og:url" content="http://localhost:1313/">

     

    

    





    <script integrity="sha256-DO4ugzEwhTW1Id1UIWn0gUJWaebCYOypeTit6LW4QB4=">
     let theme = localStorage.getItem('theme-scheme') || localStorage.getItem('darkmode:color-scheme') || 'light'
if (theme === 'system') {
  if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
    theme = 'dark'
  } else {
    theme = 'light'
  }
}
document.documentElement.setAttribute('data-theme', theme)

    </script>
    
  </head>
<body class="type-tags kind-term" data-bs-spy="scroll" data-bs-target="#TableOfContents" data-bs-offset="80">
  <div class="container-fluid bg-secondary wrapper">
    
    
    
    <nav class="navbar navbar-expand-xl top-navbar shadow " id="top-navbar">
  <div class="container">
    
    <button class="navbar-toggler navbar-light" id="sidebar-toggler" type="button">
      <i data-feather="sidebar"></i>
    </button>
    
    <a class="navbar-brand" href="/">Ray - Systems Administrator</a>
    <button
      class="navbar-toggler navbar-light"
      id="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#top-nav-items"
      aria-label="menu"
    >
      <i data-feather="menu"></i>
    </button>

    <div class="collapse navbar-collapse dynamic-navbar" id="top-nav-items">
      <ul class="nav navbar-nav ms-auto">
        <li class="nav-item">
          <a class="nav-link" href="/#home">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/#about">About</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/#skills">Skills</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/#experiences">Experience</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/#education">Education</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/#projects">Projects</a>
        </li>
        
          <li class="nav-item">
            <a class="nav-link" id="blog-link" href="/posts">Blog</a>
          </li>
        
        
            
              <li class="nav-item">
                <a class="nav-link" href="/contact">Contact</a>
              </li>
            
        
        
        
          



  
  


<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle"  href="#" id="themeSelector" role="button"
  data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
  <img id="navbar-theme-icon-svg" class="theme-icon" src="/icons/moon-svgrepo-com.svg" width=20 alt="Dark Theme">
</a>
<div id="themeMenu" class="dropdown-menu dropdown-menu-icons-only" aria-labelledby="themeSelector">
  
  <a class="dropdown-item nav-link" href="#" data-scheme="light">
    <img class="theme-icon" src="/icons/sun-svgrepo-com.svg" width=20 alt="Light Theme">
  </a>
  
  
  <a class="dropdown-item nav-link" href="#" data-scheme="dark">
    <img class="theme-icon" src="/icons/moon-svgrepo-com.svg" width=20 alt="Dark Theme">
  </a>
  
  
  <a class="dropdown-item nav-link" href="#" data-scheme="system">
    <img class="theme-icon" src="/icons/computer-svgrepo-com.svg" width=20 alt="System Theme">
  </a>
  
</div>
</li>

        
      </ul>
    </div>
  </div>
</nav>


    
    
  
  

  <section class="sidebar-section" id="sidebar-section">
    <div class="sidebar-holder">
      <div class="sidebar" id="sidebar">
        <form class="mx-auto" method="get" action="/search">
          <input type="text" name="keyword" value="" placeholder="Search" data-search="" id="search-box" />
        </form>
        <div class="sidebar-tree">
          <ul class="tree" id="tree">
            <li id="list-heading"><a href="/tags" data-filter="all">Tags</a></li>
            <div class="subtree taxonomy-terms">
              
              



  
  
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/about/" data-taxonomy-term="about"><span class="taxonomy-label">About</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/active-directory/" data-taxonomy-term="active-directory"><span class="taxonomy-label">Active Directory</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/ai/" data-taxonomy-term="ai"><span class="taxonomy-label">AI</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/automation/" data-taxonomy-term="automation"><span class="taxonomy-label">Automation</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/hugo/" data-taxonomy-term="hugo"><span class="taxonomy-label">Hugo</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term active" href="http://localhost:1313/tags/infrastructure/" data-taxonomy-term="infrastructure"><span class="taxonomy-label">Infrastructure</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/intro/" data-taxonomy-term="intro"><span class="taxonomy-label">Intro</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/it-operations/" data-taxonomy-term="it-operations"><span class="taxonomy-label">IT Operations</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/javascript/" data-taxonomy-term="javascript"><span class="taxonomy-label">JavaScript</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/monitoring/" data-taxonomy-term="monitoring"><span class="taxonomy-label">Monitoring</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/performance/" data-taxonomy-term="performance"><span class="taxonomy-label">Performance</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/portfolio/" data-taxonomy-term="portfolio"><span class="taxonomy-label">Portfolio</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/powershell/" data-taxonomy-term="powershell"><span class="taxonomy-label">PowerShell</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/scripting/" data-taxonomy-term="scripting"><span class="taxonomy-label">Scripting</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/security/" data-taxonomy-term="security"><span class="taxonomy-label">Security</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/static-site/" data-taxonomy-term="static-site"><span class="taxonomy-label">Static Site</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/trends/" data-taxonomy-term="trends"><span class="taxonomy-label">Trends</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/tutorial/" data-taxonomy-term="tutorial"><span class="taxonomy-label">Tutorial</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/web-development/" data-taxonomy-term="web-development"><span class="taxonomy-label">Web Development</span></a></li>
        
          
            
          
          <li><a class="taxonomy-term " href="http://localhost:1313/tags/welcome/" data-taxonomy-term="welcome"><span class="taxonomy-label">Welcome</span></a></li>
        
  


            </div>
          </ul>
        </div>
      </div>
    </div>
  </section>

    
<section class="content-section" id="content-section">
  <div class="content container-fluid" id="content">
    <div class="container-fluid post-card-holder" id="post-card-holder">
      
      
      
      
        
          <div class="post-card">
  <div class="card">
    <div class="card-head">
      <a href="/posts/remote-system-healthcheckpowershell/" class="post-card-link">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </a>
    </div>
    <div class="card-body">
      <a href="/posts/remote-system-healthcheckpowershell/" class="post-card-link">
        <h5 class="card-title">Remote System Health Checks with PowerShell</h5>
        <p class="card-text post-summary">Introduction Ensuring system uptime and catching performance issues early is vital in any infrastructure. With PowerShell, you can automate system health checks across your environment, collect metrics, and act on anomalies before they impact operations.
This guide walks through a practical PowerShell script for remote system health monitoring, complete with optional test coverage using Pester.
Core Principles 1. Test System Health Remotely with WMI function Test-SystemHealth { param ( [string]$ComputerName ) $result = @{ ComputerName = $ComputerName Ping = $false CPU = $null Memory = $null DiskSpace = $null } if (Test-Connection -ComputerName $ComputerName -Count 2 -Quiet) { $result.Ping = $true try { $sys = Get-WmiObject -Class Win32_OperatingSystem -ComputerName $ComputerName $cpu = Get-WmiObject -Class Win32_Processor -ComputerName $ComputerName $disk = Get-WmiObject -Class Win32_LogicalDisk -ComputerName $ComputerName -Filter &#34;DriveType=3&#34; $result.CPU = [math]::Round($cpu.LoadPercentage, 2) $result.Memory = [math]::Round((($sys.TotalVisibleMemorySize - $sys.FreePhysicalMemory) / $sys.TotalVisibleMemorySize) * 100, 2) $result.DiskSpace = @() foreach ($d in $disk) { $usedPercent = [math]::Round((($d.Size - $d.FreeSpace) / $d.Size) * 100, 2) $result.DiskSpace += @{ Drive = $d.DeviceID; UsedPercent = $usedPercent } } } catch { Write-Warning &#34;Unable to gather metrics from $ComputerName&#34; } } return $result } # Example usage $computers = Get-Content -Path &#34;.\computers.txt&#34; $healthReport = $computers | ForEach-Object { Test-SystemHealth -ComputerName $_ } $healthReport | ConvertTo-Json | Out-File &#34;.\HealthReport.json&#34; ### 2. Testing Strategy with Pester ```powershell Describe &#39;Test-SystemHealth&#39; { It &#39;Should return a result object with expected keys&#39; { $mockResult = Test-SystemHealth -ComputerName &#34;localhost&#34; $mockResult | Should -Not -BeNullOrEmpty $mockResult | Should -HaveProperty &#39;ComputerName&#39; $mockResult | Should -HaveProperty &#39;Ping&#39; $mockResult | Should -HaveProperty &#39;CPU&#39; $mockResult | Should -HaveProperty &#39;Memory&#39; $mockResult | Should -HaveProperty &#39;DiskSpace&#39; } It &#39;Should show Ping as true for localhost&#39; { $mockResult = Test-SystemHealth -ComputerName &#34;localhost&#34; $mockResult.Ping | Should -BeTrue } } </p>
      </a>
      
        <div class="tags">
  <ul style="padding-left: 0;">
    
    
    <li class="rounded"><a href="/tags/powershell/" class="btn btn-sm btn-info">PowerShell</a></li>
    
    
    <li class="rounded"><a href="/tags/automation/" class="btn btn-sm btn-info">Automation</a></li>
    
    
    <li class="rounded"><a href="/tags/scripting/" class="btn btn-sm btn-info">Scripting</a></li>
    
    
    <li class="rounded"><a href="/tags/monitoring/" class="btn btn-sm btn-info">Monitoring</a></li>
    
    
    <li class="rounded"><a href="/tags/infrastructure/" class="btn btn-sm btn-info">Infrastructure</a></li>
    
  </ul>
</div>

      
    </div>
    <div class="card-footer">
      <span class="float-start">
          Sunday, March 10, 2024
           | 2 minutes </span>
      <a
      href="/posts/remote-system-healthcheckpowershell/"
      class="float-end btn btn-outline-info btn-sm">Read</a>
    </div>
  </div>
</div>

        
      
    </div>
    <div class="paginator">
      
    </div>
  </div>
</section>

    

  </div>

  
  












  
  
    
  

  
  
    
  

  
  

  
  
    
    
  

  
  
  

  
  
  

  <footer id="footer" class="container-fluid text-center align-content-center footer pb-2">
    <div class="container pt-5">
      <div class="row text-start">
        
        <div class="col-md-4 col-sm-12">
          <h5>Navigation</h5>
          
          <ul>
            
            <li class="nav-item">
              <a class="smooth-scroll" href="http://localhost:1313/#about">About</a>
            </li>
            <li class="nav-item">
              <a class="smooth-scroll" href="http://localhost:1313/#skills">Skills</a>
            </li>
            <li class="nav-item">
              <a class="smooth-scroll" href="http://localhost:1313/#experiences">Experience</a>
            </li>
            <li class="nav-item">
              <a class="smooth-scroll" href="http://localhost:1313/#projects">Projects</a>
            </li>
            
            <li class="nav-item">
              <a href="http://localhost:1313/posts">Blog</a>
            </li>
            
            
              
                
              
            
          </ul>
          
        </div>
        
        
        <div class="col-md-4 col-sm-12">
          <h5>Contact me:</h5>
          <ul>
            
              
                <li><a href=mailto:ray@200rx.com target="_blank" rel="noopener">
                  <span><i class="fas fa-envelope"></i></span> <span>ray@200rx.com</span>
                </a></li>
              
            
              
                <li><span>Location: </span> <span>New York, Ny</span></li>
              
            
              
                <li><span>Website: </span> <span>https://200rx.com</span></li>
              
            
          </ul>
        </div>
        
        
        
      </div>
    </div>
    
    
    <hr />
    <div class="container">
      <div class="row text-start">
        <div class="col-md-4">
          <a id="theme" href="https://github.com/hugo-toha/toha" target="_blank" rel="noopener">
            <img src="/images/theme-logo.png" alt="Toha Theme Logo">
          </a>
        </div>
        <div class="col-md-4 text-center">Â© 2025 Copyright.</div>
        <div class="col-md-4 text-end">
          <a id="hugo" href="https://gohugo.io/" target="_blank" rel="noopener">Powered by
          <img
            src="/images/hugo-logo.svg"
            alt="Hugo Logo"
            height="18"
          />
          </a>
        </div>
      </div>
    </div>
    
  </footer>
<script src="/application.f2fbae73cbc3402682df1e13c1c89ef8a98a5ffa2e551c9261768d3b7824cf46.js" integrity="sha256-8vuuc8vDQCaC3x4Twcie&#43;KmKX/ouVRySYXaNO3gkz0Y=" defer></script>

   
    

</body>
</html>
