<!DOCTYPE html>
<html lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <title>Remote System Health Checks with PowerShell</title>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />

<link rel="stylesheet" href="/application.b5a2039216085b4da29787c4b1287f07c35f4e7c233e4262b80f1c312614f847.css" integrity="sha256-taIDkhYIW02il4fEsSh/B8NfTnwjPkJiuA8cMSYU&#43;Ec=" />














<meta property="og:title" content="Ray Miller - IT Infrastructure Specialist [DEV]"/>
<meta property="og:type" content="website"/>
<meta property="og:description" content=""/>
<meta property="og:image" content="/images/author/CM1.png">
<meta property="og:url" content="http://localhost:1313/">

    
<meta name="description" content="Learn how to automate system diagnostics across remote machines using PowerShell, complete with logging and test strategies" />

<link rel="stylesheet" href="/css/global-layout-fix.css">


    





    <script integrity="sha256-DO4ugzEwhTW1Id1UIWn0gUJWaebCYOypeTit6LW4QB4=">
     let theme = localStorage.getItem('theme-scheme') || localStorage.getItem('darkmode:color-scheme') || 'light'
if (theme === 'system') {
  if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
    theme = 'dark'
  } else {
    theme = 'light'
  }
}
document.documentElement.setAttribute('data-theme', theme)

    </script>
    
  </head>
<body class="type-posts kind-page" data-bs-spy="scroll" data-bs-target="#TableOfContents" data-bs-offset="80">
  <div class="container-fluid bg-secondary wrapper">
    
    
    
    <nav class="navbar navbar-expand-xl top-navbar shadow " id="top-navbar">
  <div class="container">
    
    <button class="navbar-toggler navbar-light" id="sidebar-toggler" type="button">
      <i data-feather="sidebar"></i>
    </button>
    
    <a class="navbar-brand" href="/">Ray Miller - IT Infrastructure Specialist [DEV]</a>
    <button
      class="navbar-toggler navbar-light"
      id="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#top-nav-items"
      aria-label="menu"
    >
      <i data-feather="menu"></i>
    </button>

    <div class="collapse navbar-collapse dynamic-navbar" id="top-nav-items">
      <ul class="nav navbar-nav ms-auto">
        <li class="nav-item">
          <a class="nav-link" href="/#home">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/#about">About</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/#skills">Skills</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/#experiences">Experience</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/#education">Education</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/#projects">Projects</a>
        </li>
        
          <li class="nav-item">
            <a class="nav-link" id="blog-link" href="/posts">Blog</a>
          </li>
        
        
            
              <li class="nav-item">
                <a class="nav-link" href="/services">Services</a>
              </li>
            
        
            
              <li class="nav-item">
                <a class="nav-link" href="/contact">Contact</a>
              </li>
            
        
        
        
          



  
  


<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle"  href="#" id="themeSelector" role="button"
  data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
  <img id="navbar-theme-icon-svg" class="theme-icon" src="/icons/moon-svgrepo-com.svg" width=20 alt="Dark Theme">
</a>
<div id="themeMenu" class="dropdown-menu dropdown-menu-icons-only" aria-labelledby="themeSelector">
  
  <a class="dropdown-item nav-link" href="#" data-scheme="light">
    <img class="theme-icon" src="/icons/sun-svgrepo-com.svg" width=20 alt="Light Theme">
  </a>
  
  
  <a class="dropdown-item nav-link" href="#" data-scheme="dark">
    <img class="theme-icon" src="/icons/moon-svgrepo-com.svg" width=20 alt="Dark Theme">
  </a>
  
  
  <a class="dropdown-item nav-link" href="#" data-scheme="system">
    <img class="theme-icon" src="/icons/computer-svgrepo-com.svg" width=20 alt="System Theme">
  </a>
  
</div>
</li>

        
      </ul>
    </div>
  </div>
</nav>


    
    
  <section class="sidebar-section" id="sidebar-section">
    <div class="sidebar-holder">
      <div class="sidebar" id="sidebar">
        <form class="mx-auto" method="get" action="/search">
          <input type="text" name="keyword" value="" placeholder="Search" data-search="" id="search-box" />
        </form>
        <div class="sidebar-tree">
          <ul class="tree" id="tree">
            <li id="list-heading">
              <a href="/posts/" data-filter="all">Posts</a>
              <ul class="subtree">
                
  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/system-health-checks/" title="Modern Web Development Trends in 2024">Modern Web Development Trends in 2024</a></li>
  

  
  
  
  
    
    
  
  
    
    <li><a class="active list-link" href="/posts/remote-system-healthcheckpowershell/" title="Remote System Health Checks with PowerShell">Remote System Health Checks with PowerShell</a></li>
  

  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/ad-cleanup-automation/" title="Active Directory Cleanup Automation with PowerShell">Active Directory Cleanup Automation with PowerShell</a></li>
  

  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/getting-started-with-hugo/" title="Getting Started with Hugo: A Beginner&#39;s Guide">Getting Started with Hugo: A Beginner&#39;s Guide</a></li>
  

  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/first-post/" title="Welcome">Welcome</a></li>
  


              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </section>

    
<section class="content-section" id="content-section">
  <div class="content">
    <div class="container-fluid p-0 read-area">
      
      <div class="hero-area col-sm-12" id="hero-area" style='background-image: url(/images/default-hero.jpg);'>
      </div>

      
      <div class="page-content">
        
        <div class="author-profile ms-auto align-self-lg-center">
          <img class="rounded-circle" src='%0a%0a%20%20%0a%0a%0a%0a%0a%0a%20%20%0a%0a%0a%0a%0a%0a%0a%0a%20%0a%20%0a%20%20%0a%0a%0a%0a%20%20%0a%20%20%0a%20%20%0a%0a' alt="Author Image">
          <h5 class="author-name">Corey Miller</h5>
          <p class="text-muted">Sunday, March 10, 2024</p>
        </div>
        

        <div class="title">
          <h1>Remote System Health Checks with PowerShell</h1>
        </div>

        

        
        <div class="post-content" id="post-content">
          <h2 id="introduction">Introduction</h2>
<p>Ensuring system uptime and catching performance issues early is vital in any infrastructure. With PowerShell, you can automate system health checks across your environment, collect metrics, and act on anomalies before they impact operations.</p>
<p>This guide walks through a practical PowerShell script for remote system health monitoring, complete with optional test coverage using Pester.</p>
<hr>
<h2 id="core-principles">Core Principles</h2>
<h3 id="1-test-system-health-remotely-with-wmi">1. Test System Health Remotely with WMI</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Test-SystemHealth</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">param</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="no">string</span><span class="p">]</span><span class="nv">$ComputerName</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$result</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ComputerName</span> <span class="p">=</span> <span class="nv">$ComputerName</span>
</span></span><span class="line"><span class="cl">        <span class="n">Ping</span>         <span class="p">=</span> <span class="vm">$false</span>
</span></span><span class="line"><span class="cl">        <span class="n">CPU</span>          <span class="p">=</span> <span class="vm">$null</span>
</span></span><span class="line"><span class="cl">        <span class="n">Memory</span>       <span class="p">=</span> <span class="vm">$null</span>
</span></span><span class="line"><span class="cl">        <span class="n">DiskSpace</span>    <span class="p">=</span> <span class="vm">$null</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nb">Test-Connection</span> <span class="n">-ComputerName</span> <span class="nv">$ComputerName</span> <span class="n">-Count</span> <span class="mf">2</span> <span class="n">-Quiet</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$result</span><span class="p">.</span><span class="py">Ping</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$sys</span> <span class="p">=</span> <span class="nb">Get-WmiObject</span> <span class="n">-Class</span> <span class="n">Win32_OperatingSystem</span> <span class="n">-ComputerName</span> <span class="nv">$ComputerName</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$cpu</span> <span class="p">=</span> <span class="nb">Get-WmiObject</span> <span class="n">-Class</span> <span class="n">Win32_Processor</span> <span class="n">-ComputerName</span> <span class="nv">$ComputerName</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$disk</span> <span class="p">=</span> <span class="nb">Get-WmiObject</span> <span class="n">-Class</span> <span class="n">Win32_LogicalDisk</span> <span class="n">-ComputerName</span> <span class="nv">$ComputerName</span> <span class="n">-Filter</span> <span class="s2">&#34;DriveType=3&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nv">$result</span><span class="p">.</span><span class="py">CPU</span> <span class="p">=</span> <span class="p">[</span><span class="no">math</span><span class="p">]::</span><span class="n">Round</span><span class="p">(</span><span class="nv">$cpu</span><span class="p">.</span><span class="n">LoadPercentage</span><span class="p">,</span> <span class="mf">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$result</span><span class="p">.</span><span class="py">Memory</span> <span class="p">=</span> <span class="p">[</span><span class="no">math</span><span class="p">]::</span><span class="n">Round</span><span class="p">(((</span><span class="nv">$sys</span><span class="p">.</span><span class="py">TotalVisibleMemorySize</span> <span class="p">-</span> <span class="nv">$sys</span><span class="p">.</span><span class="n">FreePhysicalMemory</span><span class="p">)</span> <span class="p">/</span> <span class="nv">$sys</span><span class="p">.</span><span class="n">TotalVisibleMemorySize</span><span class="p">)</span> <span class="p">*</span> <span class="mf">100</span><span class="p">,</span> <span class="mf">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nv">$result</span><span class="p">.</span><span class="py">DiskSpace</span> <span class="p">=</span> <span class="vm">@</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">foreach</span> <span class="p">(</span><span class="nv">$d</span> <span class="k">in</span> <span class="nv">$disk</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$usedPercent</span> <span class="p">=</span> <span class="p">[</span><span class="no">math</span><span class="p">]::</span><span class="n">Round</span><span class="p">(((</span><span class="nv">$d</span><span class="p">.</span><span class="py">Size</span> <span class="p">-</span> <span class="nv">$d</span><span class="p">.</span><span class="n">FreeSpace</span><span class="p">)</span> <span class="p">/</span> <span class="nv">$d</span><span class="p">.</span><span class="n">Size</span><span class="p">)</span> <span class="p">*</span> <span class="mf">100</span><span class="p">,</span> <span class="mf">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$result</span><span class="p">.</span><span class="py">DiskSpace</span> <span class="p">+=</span> <span class="vm">@</span><span class="p">{</span> <span class="n">Drive</span> <span class="p">=</span> <span class="nv">$d</span><span class="p">.</span><span class="n">DeviceID</span><span class="p">;</span> <span class="n">UsedPercent</span> <span class="p">=</span> <span class="nv">$usedPercent</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nb">Write-Warning</span> <span class="s2">&#34;Unable to gather metrics from </span><span class="nv">$ComputerName</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$result</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Example usage</span>
</span></span><span class="line"><span class="cl"><span class="nv">$computers</span> <span class="p">=</span> <span class="nb">Get-Content</span> <span class="n">-Path</span> <span class="s2">&#34;.\computers.txt&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$healthReport</span> <span class="p">=</span> <span class="nv">$computers</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span> <span class="nb">Test-SystemHealth</span> <span class="n">-ComputerName</span> <span class="nv">$_</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$healthReport</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="s2">&#34;.\HealthReport.json&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">### 2. Testing Strategy with Pester</span>
</span></span><span class="line"><span class="cl"><span class="p">```</span><span class="n">powershell</span>
</span></span><span class="line"><span class="cl"><span class="n">Describe</span> <span class="s1">&#39;Test-SystemHealth&#39;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">It</span> <span class="s1">&#39;Should return a result object with expected keys&#39;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$mockResult</span> <span class="p">=</span> <span class="nb">Test-SystemHealth</span> <span class="n">-ComputerName</span> <span class="s2">&#34;localhost&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$mockResult</span> <span class="p">|</span> <span class="n">Should</span> <span class="o">-Not</span> <span class="n">-BeNullOrEmpty</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$mockResult</span> <span class="p">|</span> <span class="n">Should</span> <span class="n">-HaveProperty</span> <span class="s1">&#39;ComputerName&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$mockResult</span> <span class="p">|</span> <span class="n">Should</span> <span class="n">-HaveProperty</span> <span class="s1">&#39;Ping&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$mockResult</span> <span class="p">|</span> <span class="n">Should</span> <span class="n">-HaveProperty</span> <span class="s1">&#39;CPU&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$mockResult</span> <span class="p">|</span> <span class="n">Should</span> <span class="n">-HaveProperty</span> <span class="s1">&#39;Memory&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$mockResult</span> <span class="p">|</span> <span class="n">Should</span> <span class="n">-HaveProperty</span> <span class="s1">&#39;DiskSpace&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">It</span> <span class="s1">&#39;Should show Ping as true for localhost&#39;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$mockResult</span> <span class="p">=</span> <span class="nb">Test-SystemHealth</span> <span class="n">-ComputerName</span> <span class="s2">&#34;localhost&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$mockResult</span><span class="p">.</span><span class="py">Ping</span> <span class="p">|</span> <span class="n">Should</span> <span class="n">-BeTrue</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div>
        </div>

        
        <div class="row ps-3 pe-3">
        
          <div class="col-md-6 share-buttons">
          
          </div>

        
        
        </div>



      
      <hr />
        







  





  
  

  
    
    
  
  

  
  

  
  

  
  


<div class="row next-prev-navigator">
  
    <div class="col-md-6 previous-article">
      <a href="/posts/system-health-checks/" title="Modern Web Development Trends in 2024" class="btn filled-button">
        <div><i class="fas fa-chevron-circle-left"></i> Prev</div>
        <div class="next-prev-text">Modern Web Development Trends in 2024</div>
      </a>
    </div>
  
  
      
      
        
      
      <div class="col-md-6 next-article">
        <a href="/posts/ad-cleanup-automation/" title="Active Directory Cleanup Automation with PowerShell" class="btn filled-button">
          <div>Next <i class="fas fa-chevron-circle-right"></i></div>
          <div class="next-prev-text">Active Directory Cleanup Automation with PowerShell</div>
        </a>
      </div>
    
</div>

      <hr />

      
      

      
      

      </div>
    </div>
  </div>
  
  <a id="scroll-to-top" class="btn" type="button" data-bs-toggle="tooltip" data-bs-placement="left" title="Scroll to top">
    <i class="fas fa-chevron-circle-up"></i>
  </a>
</section>

    
  <section class="toc-section" id="toc-section">
    
  </section>


  </div>

  
  












  
  
    
  

  
  
    
  

  
  

  
  
    
    
  

  
  
  

  
  
  

  <footer id="footer" class="container-fluid text-center align-content-center footer pb-2">
    <div class="container pt-5">
      <div class="row text-start">
        
        <div class="col-md-4 col-sm-12">
          <h5>Navigation</h5>
          
          <ul>
            
            <li class="nav-item">
              <a class="smooth-scroll" href="http://localhost:1313/#about">About</a>
            </li>
            <li class="nav-item">
              <a class="smooth-scroll" href="http://localhost:1313/#skills">Skills</a>
            </li>
            <li class="nav-item">
              <a class="smooth-scroll" href="http://localhost:1313/#experiences">Experience</a>
            </li>
            <li class="nav-item">
              <a class="smooth-scroll" href="http://localhost:1313/#projects">Projects</a>
            </li>
            
            <li class="nav-item">
              <a href="http://localhost:1313/posts">Blog</a>
            </li>
            
            
              
                
              
                
              
            
          </ul>
          
        </div>
        
        
        <div class="col-md-4 col-sm-12">
          <h5>Contact me:</h5>
          <ul>
            
              
                <li><a href=mailto:ray@200rx.com target="_blank" rel="noopener">
                  <span><i class="fas fa-envelope"></i></span> <span>ray@200rx.com</span>
                </a></li>
              
            
              
                <li><span>Location: </span> <span>New York, NY</span></li>
              
            
              
                <li><span>Website: </span> <span>https://200rx.com</span></li>
              
            
          </ul>
        </div>
        
        
        
          
          <div class="col-md-4 col-sm-12">
            <p>Stay up to date with email notification</p>
            
              <form method='post' action='https://blogtrottr.com'>
              <div class="form-group">
              <input type='email' class="form-control" name='btr_email' placeholder="Enter email"/><br />
              <input type='hidden' name='btr_url' value='http://localhost:1313//index.xml' />
              <input type='hidden' name='schedule_type' value='1' />
              <small id="emailHelp" class="form-text text-muted">By entering your email address, you agree to receive the newsletter of this website.</small>
              <button type="submit" class="btn btn-info"> Submit </button>
              </div>
              </form>
            
          </div>
        
      </div>
    </div>
    
    
    <hr />
    <div class="container">
      <div class="row text-start">
        <div class="col-md-4">
          <a id="theme" href="https://github.com/hugo-toha/toha" target="_blank" rel="noopener">
            <img src="/images/theme-logo.png" alt="Toha Theme Logo">
          </a>
        </div>
        <div class="col-md-4 text-center">Â© 2025 Copyright.</div>
        <div class="col-md-4 text-end">
          <a id="hugo" href="https://gohugo.io/" target="_blank" rel="noopener">Powered by
          <img
            src="/images/hugo-logo.svg"
            alt="Hugo Logo"
            height="18"
          />
          </a>
        </div>
      </div>
    </div>
    
  </footer>
<script src="/application.1074c36fa5a00b173c7607ec6258a6e8bdac1f63ca345c30e3c415da3680a0a5.js" integrity="sha256-EHTDb6WgCxc8dgfsYlim6L2sH2PKNFww48QV2jaAoKU=" defer></script>

   
</body>
</html>
